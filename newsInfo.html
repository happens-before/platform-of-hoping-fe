<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title></title>
    <script src="js/jquery-3.2.1.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/search.css">
    <link rel="stylesheet" href="layui/css/layui.css">
    <script type="text/javascript" src="js/template.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.12.5/umd/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

</head>

<body>
<div class="layui-layout layui-layout-admin">
    <!--头部导航-->
    <div id="page1" class="layui-header"></div>
    <div class="form-horizontal">
        <div class="form-group" >
        <label for="newsId" class="col-sm-2 control-label">newsId</label>
        <div class="col-sm-10">
        <input type="text" class="form-control" id="newsId" placeholder="newsId" value={{e.data.newsId}} >
        </div>
        </div>
        <div class="form-group">
            <label for="newsName" class="col-sm-2 control-label">新闻名称</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="newsName" placeholder="新闻名称" readonly="readonly"
                       value={{e.data.newsName}}>
            </div>
        </div>
        <div class="form-group">
            <label for="newsDescription" class="col-sm-2 control-label">新闻描述</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="newsDescription" placeholder="新闻描述" readonly="readonly"
                       value={{e.data.newsDescription}}>
            </div>
        </div>
        <div class="form-group">
            <label for="newsContent" class="col-sm-2 control-label">新闻内容</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="newsContent" placeholder="新闻内容" readonly="readonly"
                       value={{e.data.newsContent}}>
            </div>
        </div>
        <div class="form-group">
            <label for="newsCreator" class="col-sm-2 control-label">新闻创建者</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="newsCreator" placeholder="新闻创建者" readonly="readonly"
                       value={{e.data.newsCreator}}>
            </div>
        </div>

        <div class="form-group">
            <label for="newsCount" class="col-sm-2 control-label">新闻点击量</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="newsCount" placeholder="新闻点击量" readonly="readonly"
                       value={{e.data.newsCount}}>
            </div>
        </div>

        <div id="pictureInfo"></div>
        <div id="commentInfo"></div>
    </div>
</div>
<script src="layui/layui.js" charset="utf-8"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script>
    $("#page1").load("navHeader.html");
</script>
<script type="text/html" id="pictures">
    {{each pictures as value}}
        <div class="form-group">
            <label for="pictureId" class="col-sm-2 control-label">图片id</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="pictureId" placeholder="图片id" readonly="readonly"
                       value={{value.pictureId}}>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">图片</label>
            <div class="col-sm-10">
                <!--<input type="text" class="form-control" id="picturePath" placeholder="图片路径" readonly="readonly"-->
                       <!--value={{value.picturePath}}>-->
                <img src="{{value.picturePath}}" style="width: 200px">
            </div>
        </div>
    {{/each}}
</script>
<script type="text/html" id="comments">
    {{each comments as value}}
    <div class="form-group">
        <label for="commentContent" class="col-sm-2 control-label">评论信息</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="commentContent" placeholder="评论信息" readonly="readonly"
                   value={{value.commentContent}}---{{value.reviewer}}>
        </div>
    </div>
    {{/each}}
</script>
<script>
    window.onload=function () {
        function parseUrl(){
            var url=decodeURIComponent(location.href);
            console.log(url);
            var i=url.indexOf('?');
            if(i==-1)return;
            var querystr=url.substr(i+1);
            var arr1=querystr.split('&');
            var arr2=new Object();
            for  (i in arr1){
                var ta=arr1[i].split('=');
                arr2[ta[0]]=ta[1];
            }
            return arr2;
        }
        var v = parseUrl();
        console.log(v)
        var newsId = v.newsId
        console.log(newsId)
        $.ajax({
            xhrFields: {
                withCredentials: true
            },
            url: "http://localhost:8080/news/info", //访问路径
            type: "get",
            data: {
                "newsId": newsId
            },
            dataType: "json",
            success: function (e) {
                console.log(e)
                $("#newsId").val(e.data.newsId);
                $("#newsName").val(e.data.newsName);
                $("#newsDescription").val(e.data.newsDescription);
                $("#newsContent").val(e.data.newsContent);
                $("#newsCreator").val(e.data.newsCreator);
                $("#newsCount").val(e.data.newsCount);

                //图片
                var a= {pictures: e.data.pictures}
                console.log(a);
                var html1 = template('pictures', a);
                $("#pictureInfo").html(html1);

                //评论
                var b= {comments: e.data.comments}
                console.log(b);
                var html2 = template('comments', b);
                $("#commentInfo").html(html2);



            },
            error: function (e) {
                console.log(e);
                console.log("失败");
            },
        });
    }
</script>
</body>

</html>